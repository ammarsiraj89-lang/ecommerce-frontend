<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>User Dashboard</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style/dashbaord.css">

  <style>
    html {
      scroll-behavior: smooth;
    }

    /* GLOBAL */
    body {
      margin: 0;
      background: linear-gradient(135deg, #dbeafe, #eef2ff);
      font-family: "Segoe UI", sans-serif;
    }

    .dashboard-wrapper {
      display: flex;
      min-height: 100vh;
    }

    /* SIDEBAR */
    /* SIDEBAR (FIXED) */
    .sidebar {
      width: 260px;
      background: #1e3a8a;
      color: white;
      padding: 30px 20px;
      box-shadow: 4px 0 20px rgba(0, 0, 0, 0.2);
      position: fixed;
      /* FIXED SIDEBAR */
      left: 0;
      top: 0;
      height: 100vh;
      /* FULL HEIGHT */
      overflow-y: auto;
      /* SCROLL IF CONTENT IS LONG */
      z-index: 999;
    }

    .sidebar h2 {
      font-size: 26px;
      margin-bottom: 30px;
      font-weight: 700;
    }

    .menu-item {
      padding: 12px 14px;
      margin-bottom: 10px;
      font-size: 16px;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.3s;
    }

    .menu-item:hover,
    .menu-item.active {
      background: #3b82f6;
    }

    .home{
      text-decoration: none;
      color: white;
    }
    /* MAIN CONTENT */
    .main-area {
      flex: 1;
      padding: 35px;
      margin-left: 260px;
      /* MATCH SIDEBAR WIDTH */
    }

    /* BACK BUTTON */
    .btn-back {
      background: #1e3a8a;
      color: white;
      padding: 8px 18px;
      border: none;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s;
      box-shadow: 0 5px 15px rgba(30, 58, 138, 0.3);
    }

    .btn-back:hover {
      background: #3b82f6;
      transform: translateX(-4px);
    }


    /* TOP HEADER */
    .top-header {
      background: white;
      padding: 20px 30px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .top-header .username {
      font-size: 22px;
      font-weight: 700;
    }

    .btn-modern {
      padding: 8px 18px;
      border-radius: 10px;
      font-weight: 500;
    }

    /* SECTIONS */
    .section-card {
      background: #ffffffcc;
      backdrop-filter: blur(8px);
      padding: 25px;
      border-radius: 16px;
      margin-top: 30px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      transition: 0.3s;
    }

    .section-card:hover {
      transform: translateY(-3px);
    }

    /* Section Titles */
    .section-title {
      font-size: 22px;
      font-weight: 700;
      color: #1e3a8a;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .icon-box {
      background: #e0e7ff;
      padding: 10px 14px;
      border-radius: 12px;
      font-size: 20px;
    }

    /* PROFILE SECTION */
    .profile-box {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-top: 15px;
    }

    .profile-img {
      width: 95px;
      height: 95px;
      border-radius: 50%;
      border: 3px solid #3b82f6;
      object-fit: cover;
    }

    /* LIST ITEMS */
    .item-row {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid #e5e7eb;
      padding: 12px 0;
    }

    .badge-status {
      padding: 6px 10px;
      border-radius: 8px;
    }
  </style>
</head>

<body>

  <div class="dashboard-wrapper">

    <!-- SIDEBAR -->
    <div class="sidebar">
      <h2>Dashboard</h2>

      <a href="home.html" class="home"><div class="menu-item active">üë§ Home</div></a>
      <div class="menu-item " data-target="profileSection">üë§ Profile</div>
      <div class="menu-item" data-target="cartSection">üõí Cart</div>
      <div class="menu-item" data-target="wishlistSection">‚ù§Ô∏è Wishlist</div>
      <div class="menu-item" data-target="ordersSection">üì¶ Orders</div>

      <hr style="border-color: #3b82f690;">

      <div class="menu-item" id="logoutBtn">üö™ Logout</div>
    </div>



    <!-- MAIN AREA -->
    <div class="main-area">

      <!-- TOP HEADER -->
      <div class="top-header">

        <!-- NEW BACK BUTTON -->
        <button class="btn-back" onclick="history.back()">‚¨Ö Back</button>

        <div class="username">Welcome, <span id="userName">User</span> üëã</div>

        <div class="d-flex gap-2">
          <button class="btn btn-outline-primary btn-modern">Change Password</button>
          <button class="btn btn-outline-secondary btn-modern">Update Profile</button>
        </div>
      </div>




      <!-- PERSONAL PROFILE -->
      <div class="section-card" id="profileSection">
        <div class="section-title">
          <div class="icon-box">üë§</div> Personal Profile
        </div>

        <div class="profile-box">
          <img src="asset/default-profile.png" id="profilePic" class="profile-img">

          <div>
            <p><strong>Name:</strong> <span id="profileName">Loading...</span></p>
            <p><strong>Email:</strong> <span id="profileEmail">Loading...</span></p>
          </div>
        </div>
      </div>




      <!-- CART -->
      <div class="section-card" id="cartSection">
        <div class="section-title">
          <div class="icon-box">üõí</div> Your Cart
        </div>

        <div id="cartItems"></div>
        <p id="emptyCartMsg" class="text-muted mt-2">Your cart is empty.</p>
      </div>




      <!-- WISHLIST -->
      <div class="section-card" id="wishlistSection">
        <div class="section-title">
          <div class="icon-box">‚ù§Ô∏è</div> Wishlist
        </div>

        <div id="wishlistItems"></div>
        <p id="emptyWishlistMsg" class="text-muted mt-2">No items in wishlist.</p>
      </div>




      <!-- ORDER HISTORY -->
      <div class="section-card" id="ordersSection">
        <div class="section-title">
          <div class="icon-box">üì¶</div> Order History
        </div>

        <div id="orderHistory"></div>
        <p id="emptyOrdersMsg" class="text-muted mt-2">No orders found.</p>
      </div>

    </div>

  </div>


  <!-- üî• FIREBASE SCRIPT LOGIC SAME AS BEFORE -->
  <script type="module">
    import { watchUser, logoutUser } from "./script/firebase-auth.js";

    watchUser((user) => {
      if (!user) {
        window.location.href = "login.html";
      } else {
        document.getElementById("userName").innerText = user.email.split("@")[0];
        document.getElementById("profileEmail").innerText = user.email;
        document.getElementById("profileName").innerText = user.displayName || "Not Set";

        loadCartItems();
        loadWishlist();
        loadOrders();
      }
    });

    document.getElementById("logoutBtn").addEventListener("click", () => logoutUser());


    // SAMPLE DATA
    function loadCartItems() {
      const cart = [
        { name: "Wheelchair Comfort Pro", qty: 1, price: "‚Çπ14,999" },
        { name: "Adjustable Bed Table", qty: 2, price: "‚Çπ3,499" }
      ];

      if (cart.length === 0) return;

      document.getElementById("emptyCartMsg").style.display = "none";
      const container = document.getElementById("cartItems");

      cart.forEach(item => {
        container.innerHTML += `
      <div class="item-row">
        <span><strong>${item.name}</strong><br>Qty: ${item.qty}</span>
        <span>${item.price}</span>
      </div>`;
      });
    }

    function loadWishlist() {
      const wishlist = [
        { name: "Portable Back Support", price: "‚Çπ699" },
        { name: "Recliner Chair", price: "‚Çπ22,999" }
      ];

      if (wishlist.length === 0) return;

      document.getElementById("emptyWishlistMsg").style.display = "none";
      const container = document.getElementById("wishlistItems");

      wishlist.forEach(item => {
        container.innerHTML += `
      <div class="item-row">
        <strong>${item.name}</strong>
        <span>${item.price}</span>
      </div>`;
      });
    }

    function loadOrders() {
      const orders = [
        { id: "ORD-1023", item: "Hospital Mattress", date: "Jan 10, 2024", status: "Delivered" },
        { id: "ORD-1088", item: "Wheelchair Pro", date: "Dec 28, 2023", status: "In Transit" }
      ];

      if (orders.length === 0) return;

      document.getElementById("emptyOrdersMsg").style.display = "none";
      const container = document.getElementById("orderHistory");

      orders.forEach(order => {
        container.innerHTML += `
        <div class="item-row">
          <div>
            <strong>${order.item}</strong><br>
            <small>Order ID: ${order.id}</small><br>
            <small>${order.date}</small>
          </div>
          <span class="badge bg-primary">${order.status}</span>
        </div>`;
      });
    }

    // Sidebar section scroll
    document.querySelectorAll(".menu-item[data-target]").forEach(btn => {
      btn.addEventListener("click", function () {

        // remove active highlight
        document.querySelectorAll(".menu-item").forEach(i => i.classList.remove("active"));
        this.classList.add("active");

        // scroll to section
        const target = document.getElementById(this.dataset.target);
        target.scrollIntoView({ behavior: "smooth" });
      });
    });
  </script>

</body>

</html>